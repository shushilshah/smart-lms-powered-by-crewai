{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>AI Course Generator</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">

    <div class="card shadow p-4">
        <h3 class="mb-3">AI Course Generator</h3>

        <div class="mb-3">
            <label class="form-label">Course Prescription</label>
            <textarea id="prescription" class="form-control"
                rows="4"
                placeholder="Example: Create a beginner Django course with projects"></textarea>
        </div>

        <button class="btn btn-primary" onclick="generateCourse()">
            Generate Course
        </button>
    </div>

    <div class="card shadow mt-4 p-4 d-none" id="resultCard">
        <h4>Generated Course</h4>
        <div id="resultContent"></div>
    </div>

</div>

<script>
async function generateCourse() {

    const prescription = document.getElementById("prescription").value;

    if (!prescription) {
        alert("Please enter a course description.");
        return;
    }

    const response = await fetch("/ai/generate-course/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify({ prescription })
    });

    const data = await response.json();

    const resultCard = document.getElementById("resultCard");
    const resultContent = document.getElementById("resultContent");

    resultCard.classList.remove("d-none");

    if (data.error) {
        resultContent.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
        return;
    }

    resultContent.innerHTML = `
        <h5>${data.title}</h5>
        <p><strong>Description:</strong> ${data.description}</p>
        <p><strong>Level:</strong> ${data.level}</p>
        <p><strong>Duration:</strong> ${data.estimated_duration}</p>
        <p><strong>Learning Outcomes:</strong></p>
        <ul>
            ${data.learning_outcomes.map(item => `<li>${item}</li>`).join("")}
        </ul>
    `;
}
</script>

</body>
</html>
